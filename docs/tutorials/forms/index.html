<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Product">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>Get Input from a Form | Dart: Structured web apps</title>
  <meta property="twitter:account_id" content="376585411" />
  <meta itemprop="name" content="Get Input from a Form | Dart: Structured web apps">
  
  <meta itemprop="image" content="https://www.dartlang.org/imgs/dart-logo-wordmark-1200w.png">
  
  <meta itemprop="description" content="Using HTML forms and input elements to send data to a server">



<!-- making pagespeed insights happy -->
<style>
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 400;
  src: url(https://themes.googleusercontent.com/static/fonts/montserrat/v4/zhcz-_WihjSQC0oHJ9TCYL3hpw3pgy2gAi-Ip7WPMi0.woff) format('woff');
}
@font-face {
  font-family: 'Montserrat';
  font-style: normal;
  font-weight: 700;
  src: url(https://themes.googleusercontent.com/static/fonts/montserrat/v4/IQHow_FEYlDC4Gzy_m8fcnbFhgvWbfSbdVg11QabG8w.woff) format('woff');
}
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 300;
  src: url(https://themes.googleusercontent.com/static/fonts/roboto/v10/Hgo13k-tfSpn0qi1SFdUfbO3LdcAZYWl9Si6vvxL-qU.woff) format('woff');
}
@font-face {
  font-family: 'Roboto';
  font-style: normal;
  font-weight: 400;
  src: url(https://themes.googleusercontent.com/static/fonts/roboto/v10/CrYjSnGjrRCn0pd9VQsnFOvvDin1pK8aKteLpeZ5c0A.woff) format('woff');
}
</style>

<link rel='stylesheet' type='text/css' href='http://takyam-git.github.io/www.dartlang.org/bundles/96e4b278be2e9b94cffcad9b0b04384c.css' />


  
  

  <link rel="alternate" type="application/atom+xml" href="http://news.dartlang.org/feeds/posts/default" title="Atom feed">
  <link href="https://plus.google.com/109866369054280216564" rel="publisher">

  <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="js/html5shiv.js"></script>
    <script src="js/respond.min.js"></script>
  <![endif]-->

  <script>

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-49880327-3', 'dartlang.org');
ga('create', 'UA-26406144-4',
    {'cookieDomain': 'dartlang.org',
     'siteSpeedSampleRate': 50,
     'name': 'dartlangTracker'});

ga('send', 'pageview');
ga('dartlangTracker.send', 'pageview');

</script>


  <script async="" defer="" src="http://takyam-git.github.io/www.dartlang.org/survey.g.doubleclick.net/async_survey?site=apno2k33xucna4srya26u4i2ri"></script>

</head>
<body onload="prettyPrint()" data-spy="scroll" data-target=".bs-sidebar">

    <div class="navbar navbar-fixed-top navbar-inverse" role="navigation">
      <div class="dart-developer-summit-reg" style="text-align:center;background-color: hsl(172,67%,80%);">
        <a href="http://takyam-git.github.io/www.dartlang.org/events/2015/summit/">Watch sessions from the first Dart Developer Summit</a>
      </div>
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://takyam-git.github.io/www.dartlang.org/"><i class="sprite-icon-dart-logo"></i></a>
        </div>

        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
           <li class="dropdown">
              <a href="#" class="dropdown=toggle" data-toggle="dropdown">
                Get Started <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">

                <i class="sprite-icon-dd-tip"></i>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/codelabs/darrrt/">Learn Dart in Minutes</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/downloads/">Download Dart</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                    Fundamentals <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/dart-up-and-running/ch02.html">Language Tour</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/dart-up-and-running/ch03.html">Library Tour</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/">Programmer's Guide</a></li>

                <li class="divider"></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/tools/">Dart Tools</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/tools/pub/">Pub Package and Asset Manager</a></li>

                <li class="divider"></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/get-started/">Tutorial: Get Started</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/shared-pkgs/">Tutorial: Packages</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/futures/">Tutorial: Async</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                    Browser<span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/polymer/">Polymer</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/codelabs/polymer/">Polymer Code Lab</a></li>
                <li class="divider"></li>
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/connect-dart-html/">Tutorial: HTML</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/polymer-intro/">Tutorial: Polymer</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/fetchdata/">Tutorial: Forms & Data</a></li>
                <li class="divider"></li>
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/tools/editor/mobile.html">Mobile</a></li>

                <li class="divider"></li>
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/googleapis/">Google APIs Client Libraries</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                    Server <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/cmdline/">Tutorial: Basic Command-Line Apps</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/httpserver/">Tutorial: HTTP Servers and Clients</a></li>

                <li class="divider"></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/server/google-cloud-platform/">Deploying Your Server Application</a></li>
                <i class="sprite-icon-dd-tip"></i>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/googleapis/">Using Google APIs from Your Server</a></li>

                <li class="divider"></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/serverguide.html">Additional Resources</a></li>
              </ul>
            </li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                    More <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                <i class="sprite-icon-dd-tip"></i>

                <li><a href="http://takyam-git.github.io/www.dartlang.org/samples/">Code Samples</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/synonyms/">Synonyms with Other Languages</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/dart-by-example/">Dart by Example</a></li>

                <li class="divider"></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/articles/">Articles</a></li>
                <li><a href="http://api.dartlang.org">API Reference</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/spec/">Language Specification</a></li>

                <li class="divider"></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/community/who-uses-dart.html">Who Uses Dart</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/support/faq.html">FAQ</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/logos/">Logos and Colors</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/books/">Books</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/performance/">Performance</a></li>

                <li class="divider"></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/slides/">Presentations</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/dart-tips/">Dart Tips Videos</a></li>
                <li><a href="http://takyam-git.github.io/www.dartlang.org/support/">Support</a></li>
              </ul>
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li>
              <form class="navbar-search" action="/search.html" id="cse-search-box">
                <input type="hidden" name="cx" value="011220921317074318178:i4mscbaxtru">
                <input type="hidden" name="ie" value="UTF-8">
                <input type="hidden" name="hl" value="en">
                <input type="search" name="q" class="search-query placeholder-position-fix form-control" id="q" autocomplete="off" placeholder="Search">
              </form>
            </li>
            <li><a href="https://twitter.com/dart_lang" class="btn"><i class="sprite-icon-social-twitter"></i></a></li>
            <li><a href="https://plus.google.com/+dartlang/posts" class="btn"><i class="sprite-icon-social-gplus"></i></a></li>
          </ul>
        </div><!-- /.nav-collapse -->

      </div><!-- /.container -->
    </div><!-- /.navbar -->


<div class="container-page">
  <div class="container">
    <div class="container col-md-12 col-md-offset-0 sub-page">
      <div class="has-permalinks">
      
<!-- NAVI LINKS -->
<div id="tutorial-navigation-links-top" class="row">
  <div class="col-md-12">
    <div class="row">
      <div class="col-md-3">
        <a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/"><img src="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/images/tute-home.png" width="36" /></a>
      </div>
      <div class="col-md-3">
        <a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/fetchdata/"><i class="glyphicon glyphicon-chevron-left"> </i> Fetch Data Dynamically</a>
      </div>
      <div class="col-md-3">
      </div>
      <div class="col-md-3">
        <a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/indexeddb/" class="pull-right">Use IndexedDB <i class="glyphicon glyphicon-chevron-right"> </i> </a>
      </div>
    </div> 
    <hr />
  </div> 
</div>

<!-- PAGE -->
<div class="row">

  <!-- LEFT SIDE BAR -->
  <div class="col-md-3">

    <div id="tutorial-side">
      <div id="whats-the-point">
        <h4 id="page-highlights">What's the point?</h4>
        
<ul>
  <li>Use forms with inputs to gather data from a user.</li>
  <li>Send data to the server, declaratively or programmatically.</li>
  <li>Get the response from the server with HttpRequest.</li>
  <li>Handle communication asynchronously with Futures.</li>
  <li>Use HttpServer to set up a server to listen on a port and host.</li>
  <li>Use CORS headers to set access permissions for each request.</li>
  <li>Use Polymer data binding to sync form data and Dart data.</li>
</ul>


      </div> <!-- whats-the-point -->

      <div id="code-links">
        <h4 id="examples">Examples</h4>

        
<p> This tutorial features these examples:</p>
<ul>
  <li>search_form</li>
  <li>slambook</li>
</ul>

<p>
Don't have the source code?
<a href="https://github.com/dart-lang/dart-tutorials-samples/archive/master.zip">
  Download it.
</a>

</p>


        <a href="https://drone.io/github.com/dart-lang/dart-tutorials-samples/latest">
           <img src="https://drone.io/github.com/dart-lang/dart-tutorials-samples/status.png" alt="Build Status" style="margin-top:10px;max-width:100%;" />
        </a>
      </div> <!-- end code-links -->

      <div id="tutorial-toc">
        <a href="https://github.com/dart-lang/dartlang.org/issues" target="_blank">
        <i class="glyphicon glyphicon-comment"> </i>
        Send feedback
        </a>
      </div> <!-- tutorial-toc -->
      
    </div> <!-- tutorial-side -->

  </div> <!-- end div col-md-3 -->

  <!-- CONTENT-->
  <article class="col-md-9 tutorial-content">

    
<div class="tute-target-title">
<h1>Get Input from a Form</h1>
<h3>Use forms to get data from users.</h3>
</div>

<p>Many web applications rely on forms to collect data
and submit that data to a server.
A form usually contains several input elements
for entering data of various kinds,
such as names and addresses, birthdays, email addresses,
and so on.
HTML supports several kinds of input elements,
including text fields, text areas, radio buttons, and checkboxes.
HTML5 adds more specialized input elements such
as email and password fields,
color pickers, date and time widgets, and range elements.</p>

<p>The main example in this tutorial contains a client and a server.
The client uses Polymer to present its user interface
(a form with many kinds of input elements),
and keep the interface in sync with Dart data.
The client and server communicate using
several classes from various Dart libraries,
including streams, Futures, HttpRequest, and so on.
The server uses CORS headers to allow cross-origin requests.</p>

<aside class="alert alert-info">
  <p><strong>Note:</strong>
  This tutorial assumes that you have read
  <a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/polymer-intro/">Define a Custom Element</a>,
  <a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/futures/">Use Future-Based APIs</a>,
  and <a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/fetchdata/">Fetch Data Dynamically</a>
  and are familiar with Polymer, Futures, JSON, and HttpRequest.</p>
</aside>

<ul>
  <li><a href="#about-forms">About forms, generally</a></li>
  <li><a href="#about-the-slambook-example">About the slambook example, specifically</a></li>
  <li><a href="#submitting-a-form">Submitting a form</a></li>
  <li><a href="#resetting-a-form">Resetting a form</a></li>
  <li><a href="#creating-a-server">Creating a server and listening on a port</a></li>
  <li><a href="#handling-options-requests">Handling OPTIONS requests</a></li>
  <li><a href="#setting-cors-headers">Setting CORS headers</a></li>
  <li><a href="#handling-post-requests">Handling POST requests</a></li>
  <li><a href="#recipe">Recipe for client-server web apps</a></li>
  <li><a href="#binding-data">Two-way data binding using Polymer</a></li>
  <li><a href="#other-resources">Other resources</a></li>
  <li><a href="#what-next">What next?</a></li>
</ul>

<h2 id="about-forms">About forms, generally</h2>

<p>A form has an <em>action</em>, which is a URL to which to send the form data,
and a <em>method</em>, which indicates how the form data is to be sent.
The action and the method can be specified declaratively within HTML,
or for more complex situations or for more control,
you can write Dart code and use Dart libraries to perform the action
programmatically.</p>

<p>Let’s begin with a basic, HTML-only form to learn a little bit about
action, method, input elements, and the default behavior of forms.
The form below uses Google to search the website
specified in the &lt;form&gt; tag
if the checkbox is selected
(or the web if it is not),
for the text entered by the user.
In this example,
called <code>search_form</code>,
the default is to search
<a href="http://www.dartlang.org">dartlang.org</a>
for “Cookbook”,
a useful resource for learning about Dart.</p>

<iframe class="running-app-frame" style="height:100px;width:500px;" src="examples/search_form/web/search_form.html">
</iframe>

<p>Here is the HTML code that creates the form:</p>

<pre class="prettyprint lang-html">
&lt;form action=&quot;http://www.google.com/search&quot;
      method=&quot;GET&quot;
      target=&quot;_blank&quot;&gt;
  ...
&lt;/form&gt;
</pre>

<p>Of interest are the <code>action</code> and <code>method</code> attributes.</p>

<table class="table">
  <thead>
    <tr>
      <th>Attribute</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>action</td>
      <td>The URL to which to send the request. In this example, the URL specifies a Google search. When the user clicks the button, search parameters are appended to this URL.</td>
    </tr>
    <tr>
      <td>method</td>
      <td>How to send the request. In general, you should use GET to request data from a resource and POST to submit data to a server.</td>
    </tr>
  </tbody>
</table>

<p>And here is the HTML code that puts three input elements—a text field,
a submit button, and a checkbox—into the form:</p>

<pre class="prettyprint lang-html">
&lt;input   type=&quot;text&quot;     name=&quot;q&quot;
                         value=&quot;Cookbook&quot; size=&quot;31&quot; maxlength=&quot;255&quot;&gt;
&lt;input   type=&quot;submit&quot;   value=&quot;Google Search&quot;&gt;
&lt;label&gt;
  &lt;input type=&quot;checkbox&quot; name=&quot;sitesearch&quot;
                         value=&quot;dartlang.org&quot; checked&gt; Search dartlang.org&lt;br&gt;
&lt;/label&gt;
</pre>

<p>The checkbox is wrapped in a label
so that you can click either the checkbox
or the label to change the selection.</p>

<p>This HTML code provides some automatic behaviors.</p>

<dl>
  <dt> &lt;input type="submit" ...&gt; </dt>
  <dd> Creates a special button that when clicked,
       gathers the data from the form.
       Based on the action and method attributes,
       the button formulates the request
       and submits it to the server at the URL provided.
  </dd>
  <dt> name="q" </dt>
  <dt> name="sitesearch" </dt>
  <dd>
    <p>Specifies the name of the text field
       and the name of the checkbox.</p>

    <p>Within a form,
  the input elements that have names provide the data for the form.
  In this example,
  the value of the text field provides the value for <code>q</code>,
  and the checkbox provides the value for <code>sitesearch</code>,
  both part of a valid Google search URL.
  The name and its value are appended to the search URL
  when the user clicks the submit button.
  For example,</p>

    <pre class="prettyprint">
http://www.google.com/search?q=Cookbook&amp;sitesearch=dartlang.org
</pre>
  </dd>

</dl>

<p>The example is purely declarative with no Dart or JavaScript code.
Because its simple, it can use the default HTML form behavior,
a publicly available and easily formed URL,
and a basic GET request.
For forms that contain a lot of data,
or for web applications that communicate with a specialized server,
you usually need to handle forms programmatically.</p>

<p>The next example shows a more complex form that sends data
to a server programmatically using a POST request.</p>

<h2 id="about-the-slambook-example">About the slambook example, specifically</h2>

<p>The primary example in this tutorial consists of two programs.</p>

<ul>
  <li>
    <p>First,
a basic server program, called <code>slambookserver</code>,
listens on port 4040 on the local host
and handles POST and OPTIONS requests
by printing a message and sending a confirmation to the client.
The server uses CORS headers to allow requests from applications
running from a different origin.</p>
  </li>
  <li>
    <p>Second,
the client program,
called <code>slambook</code>,
provides a form into which users can enter some information.
It uses Polymer two-way data binding to bind the input data to Dart variables.
When the user clicks the submit button,
the Dart code formats the data into a JSON string,
sends an OPTIONS request to get permission from the server,
and then a POST request to send the data.
When the response from the server is ready,
the client displays it.</p>
  </li>
</ul>

<p>The following diagram shows the flow of communication between
the server and the client in this example.</p>
<hr />

<p><img class="scale-img-max" src="images/client-server-comm.png" alt="Client-server communication in the slambook example" /></p>

<hr />

<p><strong>Try it!</strong>
Enter some data and push the <strong>Submit</strong> button.</p>

<iframe class="running-app-frame" style="height:500px;width:550px;" src="examples/slambook/web/slambook.html">
</iframe>

<aside class="alert">
<strong>Version Note:</strong> The slambook app
is compatible with
<a href="https://pub.dartlang.org/packages/polymer#versions">polymer.dart 0.11</a>.
</aside>

<p>The request gives you an innocent stare and displays “No server”
because you are not running the server on your machine.
Let’s fix that.</p>

<h3 id="run-the-server">Run the server</h3>

<p>Get the source code for the basic server program,
slambookserver.dart,
from the
<a href="https://github.com/dart-lang/dart-tutorials-samples/archive/master.zip">
 tutorials samples
</a>
download.</p>

<p>Run the server program from the command line:</p>

<pre class="prettyprint">
% dart slambookserver.dart
Listening for GET and POST on http://127.0.0.1:4040
</pre>

<p>Now, you can try submitting data again with the slambook app above.</p>

<aside class="alert alert-info">
<b>Note:</b> If another program is already listening on localhost 4040,
the server prints an error message and quits.
The app running on this page expects slambookserver to be at localhost 4040,
so for the app to work,
you have to kill the other process and start slambookserver again.
Alternatively,
you can change the port number in both the client and the server code.
(Avoid using 3030; Dart Editor listens there.)
Then run both the client and the server locally on your machine.
</aside>

<p>The rest of this tutorial explains the code for both the client and the server.</p>

<p>On the client side, you learn about</p>

<ul>
  <li>Submitting the form</li>
  <li>Resetting the form</li>
  <li>Using Polymer to bind the form data to variables in the Dart program</li>
</ul>

<p>On the server side, the sections cover</p>

<ul>
  <li>CORS headers</li>
  <li>Handling OPTIONS requests</li>
  <li>Handling POST requests</li>
</ul>

<h2 id="submitting-a-form">Submitting a form</h2>

<p>Let’s first take a look at how the data is submitted to the server.</p>

<p>Recall that the search_form example relies on the <code>action</code> and
<code>method</code> attributes to set the destination and method for the form request.
Recall also that the search_form example relies
on the automatic behavior of the special submit button.
The slambook example,
on the other hand,
takes explicit control of the form submission process.</p>

<ul>
  <li>First, the form specifies no action or method.</li>
  <li>Second, the submit button has a Dart mouse click handler.</li>
  <li>Third, the mouse click handler prevents
the automatic behavior of the submit button.</li>
  <li>Finally, the form submits the data to the server
with help from the Dart libraries.</li>
</ul>

<p>The form in the slambook example is
a custom element called <code>tute-slambook-form</code>
that’s instantiated with this HTML code:</p>

<pre class="prettyprint lang-html">
&lt;div class=&quot;container&quot;&gt;
  &lt;form is=&quot;tute-slambook-form&quot; id=&quot;slambookform&quot;&gt;&lt;/form&gt;
&lt;/div&gt;
</pre>

<p>Note the absence of either an <code>action</code> or a <code>method</code> attribute.
Instead, the behavior for the submit button is coded in a Dart
mouse click handler.
Below is the HTML code that creates the submit button
and binds it to a Dart mouse click handler.</p>

<pre class="prettyprint lang-html">
&lt;div class=&quot;submitarea&quot;&gt;
  &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; on-click=&quot;{{submitForm}}&quot;&gt;
  ...
&lt;/div&gt;
</pre>

<p>Here’s the code for the submitForm() mouse click handler:</p>

<p><img class="scale-img-max" src="images/post-request.png" alt="Making a post request" /></p>

<p>Let’s walk through the click handler’s code.</p>

<h3 id="suppressing-the-default-action">Suppressing the default action</h3>

<p>Even without an <code>action</code> and a <code>method</code> attribute,
the submit button has some automatic behavior,
which the slambook example does not need.
So the first line of code in
the mouse click handler calls <code>e.preventDefault()</code>
to suppress the default behavior of the submit button.</p>

<pre class="prettyprint lang-dart">
void submitForm(Event e) {
  e.preventDefault(); // Don&#39;t do the default submit.
  ...
}
</pre>

<h3 id="setting-up-and-making-the-post-request">Setting up and making the POST request</h3>

<p>Next, the code creates an
<a href="https://api.dartlang.org/dart_html/HttpRequest.html" target="_blank">HttpRequest</a>
object.
This code uses <code>new</code> to create an HttpRequest object,
which needs to be configured to make a POST request.
The HttpRequest class has a convenience function, getString(),
that you can use to make a basic GET request on a URL.</p>

<p>The next line provides the HttpRequest object with a callback function,
called <code>onData</code>,
that gets invoked when the server responds.
We’ll look at the implementation details for onData() later.</p>

<p><strong>Important:</strong>
You must register the callback function
before making the request!</p>

<pre class="prettyprint lang-dart">
request = new HttpRequest();
request.onReadyStateChange.listen(onData);

var url = &#39;http://127.0.0.1:4040&#39;;
request.open(&#39;POST&#39;, url);
request.send(slambookAsJsonData());
</pre>

<p>Next, the code opens a POST request
with a URL specifying the port and host
on which slambookserver is listening.</p>

<p>Finally, the function sends the form data as a JSON string to the server.
Sometimes, the data is streamed in chunks.
But in this example,
the data is short enough that all of the data is sent at once.
This request is asynchronous,
so the send() method returns as soon as the request is sent.</p>

<h3 id="listening-for-the-server-response">Listening for the server response</h3>

<p>The HttpRequest object handles communication with the server.
You can get the state of that communication through
the HttpRequest object’s <code>readyState</code> field.
The ready state has five possible values:
unsent, opened, headers received, loading, and done.
When the ready state changes, HttpRequest fires an event,
and the onData() callback function gets called.</p>

<p>Recall the line of code that registers onData as a listener
on the <code>onReadyStateChange</code> event stream:</p>

<pre class="prettyprint lang-dart">
request.onReadyStateChange.listen(onData);
</pre>

<p>The only required argument to the listen() method
is a callback function with this signature: <em>void onData(T)</em>.
The listen() method also lets
you specify three optional arguments,
such as an error handler.</p>

<p>The onData() callback function is straightforward:</p>

<pre class="prettyprint lang-dart">
void onData(_) {
  if (request.readyState == HttpRequest.DONE &amp;&amp;
      request.status == 200) {
    // Data saved OK.
    serverResponse = &#39;Server Sez: &#39; + request.responseText;
  } else if (request.readyState == HttpRequest.DONE &amp;&amp;
      request.status == 0) {
    // Status is 0...most likely the server isn&#39;t running.
    serverResponse = &#39;No server&#39;;
  }
}
</pre>

<p>First the code checks whether the request is complete and successful.
If it is, the code puts the server’s response in a string,
called <code>serverResponse</code>, which is bound to the value of a textarea
in the slambook app’s UI.
When the string changes, the UI is automatically updated,
and the message is displayed for the user.</p>

<p>If the request is complete but unsuccessful,
the program sets <code>serverResponse</code> to an error message,
thus displaying it to the user.</p>

<h2 id="resetting-a-form">Resetting a form</h2>

<p>The reset button is a special HTML input type that, by default,
clears the values of all inputs within the form.
Instead, we want the button to reset the values in the form
to their initial value.
So, the mouse click handler for the reset button
needs to suppress the automatic behavior
and reset the form with neutral data explicitly.</p>

<pre class="prettyprint lang-dart">
void resetForm(Event e) {
  e.preventDefault();
  favoriteThings[&#39;kittens&#39;] = false;
  favoriteThings[&#39;raindrops&#39;] = false;
  favoriteThings[&#39;mittens&#39;] = false;
  favoriteThings[&#39;kettles&#39;] = false;

  theData[&#39;firstName&#39;] = &#39;&#39;;
  theData[&#39;favoriteQuote&#39;] = &#39;&#39;;
  theData[&#39;favoriteColor&#39;] = &#39;#FFFFFF&#39;;
  theData[&#39;birthday&#39;] = &#39;2013-01-01&#39;;
  theData[&#39;volume&#39;] = &#39;0&#39;;
  theData[&#39;catOrDog&#39;] = &#39;cat&#39;;
  theData[&#39;music&#39;] = 0;
  theData[&#39;zombies&#39;] = false;
  serverResponse = &quot;Data reset.&quot;;
}
</pre>

<h2 id="creating-a-server">Creating a server and listening on a port</h2>

<p>Let’s turn our attention now to the server, called <code>slambookserver</code>,
that responds to HTTP requests from the slambook client.
The code for the server is based
on the one in Chris Buckett’s article
<a href="http://takyam-git.github.io/www.dartlang.org/articles/json-web-service/">Using Dart with JSON Web Services</a>.</p>

<p>The server listens on port 4040 on the local host
and handles only POST and OPTIONS requests.
For both types of requests,
the server adds CORS headers to allow access.
For POST requests,
the server returns a short confirmation message
that includes the JSON data it received in the request.</p>

<p>Let’s take a look at the code.</p>

<p>Below is the entire main() function for slambookserver.
Using the
<a href="https://api.dartlang.org/dart_io/HttpServer.html" target="_blank">HttpServer</a>
class,
slambookserver starts listening on port 4040 on the local host
by calling the top-level bind() function.</p>

<pre class="prettyprint lang-dart">
final HOST = &#39;127.0.0.1&#39;;
final PORT = 4040;

void main() {
  HttpServer.bind(HOST, PORT).then(gotMessage, onError: printError);
}
</pre>

<p>The bind() function returns a Future object,
which is a way to get a value in the future (more about that in a minute).
Using then(),
the code registers two callback functions on the Future.
The first, gotMessage(), is called when the Future returns its value.
The second, <code>printError</code>, is called if the binding fails.
An error might occur if, for example,
another program is already listening on the same port.</p>

<p>The code for gotMessage(), shown below, filters the request
and calls other methods to handle each specific kind of request.</p>

<pre class="prettyprint lang-dart">
void gotMessage(_server) {
  _server.listen((HttpRequest request) {
    switch (request.method) {
      case &#39;POST&#39;:
        handlePost(request);
        break;
      case &#39;OPTIONS&#39;:
        handleOptions(request);
        break;
      default: defaultHandler(request);
    }
  },
  onError: printError); // Listen failed.
  print(&#39;Listening for GET and POST on http://$HOST:$PORT&#39;);
}
</pre>

<p>To handle other types of requests
such as <code>GET</code> requests,
you could simply add more <code>case</code> statements,
such as <code>case 'GET'</code>.</p>

<h3 id="about-futures-briefly">About Futures, briefly</h3>

<p>Let’s take a brief look at Futures before we check out the code
for handling OPTIONS and POST requests.</p>

<p>A
<a href="https://api.dartlang.org/dart_async/Future.html" target="_blank">Future</a>
represents a way to get a value sometime in the Future.
You use Futures to avoid blocking the program
while waiting for a value—for example,
if the value requires a long time to compute,
or if the value must be read or retrieved using I/O.</p>

<p>When a function that returns a Future is invoked,
two things happen:</p>

<ul>
  <li>
  The function queues up work to be done
  and returns an uncompleted Future object immediately.
  </li>
  <li>
  Later, when the value is available,
  the Future object completes with that value or with an error.
  </li>
</ul>

<p>To get the value that the Future represents,
use the then() method to register a callback.
When the Future completes, it calls
the callback function.</p>

<p>In this example,
both the client and server use Futures when sending requests
and responses back and forth.
Client-server programs should almost always handle communication
and other forms of I/O asynchronously with Futures.</p>

<h2 id="handling-options-requests">Handling OPTIONS requests</h2>

<p>With help from the
<a href="https://api.dartlang.org/dart_html/HttpRequest.html" target="_blank">HttpRequest</a>
class, the slambook client makes a POST request
when the user clicks the submit button.
You saw the code for this earlier in this tutorial.</p>

<p>If the client is running from a different origin than the server,
which is common in web apps,
the POST request is “preflighted”.
A preflighted request must first send an OPTIONS request
to determine if the actual request is allowed.
The HttpRequest class
automatically handles the preflight OPTIONS request.
You do not have to write the client-side code for that.</p>

<p>The server gets the OPTIONS request before it gets the preflighted request.
Here’s the slambookserver code that handles OPTIONS requests.</p>

<pre class="prettyprint lang-dart">
void handleOptions(HttpRequest req) {
  HttpResponse res = req.response;
  addCorsHeaders(res);
  print(&#39;${req.method}: ${req.uri.path}&#39;);
  res.statusCode = HttpStatus.NO_CONTENT;
  res.close();
}
</pre>

<p>The code is straightforward:</p>

<ul>
  <li>Get the
<a href="https://api.dartlang.org/dart_io/HttpResponse.html" target="_blank">HttpResponse</a>
object,
which carries the server’s response to the client.</li>
  <li>Add CORS headers to set access control</li>
  <li>Print a message to the console</li>
  <li>Indicate that the response has no content</li>
  <li>Close the response, thus sending the response to the client.</li>
</ul>

<p>When the client gets the response,
the CORS headers indicate that a POST request would be accepted.</p>

<h2 id="setting-cors-headers">Setting CORS headers</h2>

<p>The server uses the following function
to add CORS headers to its response to both OPTIONS and POST requests.
The function adds three Access-Control headers to the
server’s response (contained in an
<a href="https://api.dartlang.org/dart_html/HttpRequest.html" target="_blank">HttpResponse</a>
object).</p>

<pre class="prettyprint lang-dart">
void addCorsHeaders(HttpResponse res) {
  res.headers.add(&#39;Access-Control-Allow-Origin&#39;, &#39;*&#39;);
  res.headers.add(&#39;Access-Control-Allow-Methods&#39;, &#39;POST, OPTIONS&#39;);
  res.headers.add(&#39;Access-Control-Allow-Headers&#39;,
      &#39;Origin, X-Requested-With, Content-Type, Accept&#39;);
}
</pre>

<p>Together,
the first two CORS headers allow
POST and OPTIONS requests from any origin.
The third specifies
the kind of POST and OPTIONS requests the server accepts
by specifying the headers that it allows.</p>

<p>For more information about CORS refer to:</p>

<ul>
  <li><a href="http://www.html5rocks.com/en/tutorials/cors/">Using CORS</a></li>
</ul>

<h2 id="handling-post-requests">Handling POST requests</h2>

<p>Here is the function that handles the client’s HTTP POST request:</p>

<pre class="prettyprint lang-dart">
void handlePost(HttpRequest req) {
  HttpResponse res = req.response;
  print(&#39;${req.method}: ${req.uri.path}&#39;);

  addCorsHeaders(res);

  req.listen((List&lt;int&gt; buffer) {
    // Return the data back to the client.
    res.write(&#39;Thanks for the data. This is what I heard you say: &#39;);
    res.write(new String.fromCharCodes(buffer));
    res.close();
  },
  onError: printError);
}
</pre>

<p>As with the OPTIONS request,
slambookserver gets the HTTP response object from the request,
prints a message to the console,
and adds the CORS headers to the response.</p>

<p>Next the code listens for the data
from the client’s POST request.
When <em>all</em> the data is ready,
the callback function gets called.
The callback function is written in place as a function literal.
The argument to the function, a list of integers,
contains all of the data.
Each integer is a character code,
which can be a UTF-16 code unit or rune.
You don’t need to worry about this,
because you can just use the String.fromCharCodes()
method to convert the list of character codes into a normal string.</p>

<p>The HttpResponse object manages a data stream
that the server can use to send data back to the client.
Within the data callback function,
slambookserver writes a message and the original data as a string
to that stream.
A more sophisticated server would do something with the data,
such as save it on the server,
process it, and maybe remove funds from your
bank account.</p>

<p>Upon closing the stream,
the HttpResponse object sends the data to the client.</p>

<h2 id="recipe">Recipe for client-server web apps</h2>

<p>The slambook client-server example
can serve as a starting point for your client-server web apps
or as a recipe for building your own.</p>

<p>Here’s an outline of what the client needs to do.</p>

<ul>
  <li>Use forms to gather data from a user.</li>
  <li>Put input fields in your forms for individual data items.</li>
  <li>Use Polymer two-way binding to keep the form data in sync with the Dart code.</li>
  <li>Send data declaratively (action and method attributes on the form)</li>
  <li>… or programmatically (overriding the default behavior of
the submit button with Dart code)</li>
  <li>Get the response from the server from the HttpRequest object.</li>
  <li>Handle communication asynchronously with a Future object.</li>
</ul>

<p>And, here’s what the server needs to do.</p>

<ul>
  <li>Use HttpServer to set up a server to listen on a port and host.</li>
  <li>Listen for requests.</li>
  <li>Use CORS headers to set access permissions for each request.</li>
  <li>Respond to requests using HttpResponse.</li>
  <li>Handle communication asynchronously with Futures.</li>
  <li>Use streams to write the response data.</li>
</ul>

<p>These resources, mostly from the core Dart libraries,
provide support for writing clients and servers.
Note that there are two HttpRequest classes, one in dart:html (for clients)
and one in dart:io (for servers).</p>

<table class="table">
  <thead>
    <tr>
      <th>Resource</th>
      <th>Library</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://api.dartlang.org/dart_html/HttpRequest.html" target="_blank">HttpRequest</a></td>
      <td>dart:html</td>
      <td>Client-side HTTP request</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dart_io/HttpRequest.html" target="_blank">HttpRequest</a></td>
      <td>dart:io</td>
      <td>Server-side HTTP request</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dart_io/HttpServer.html" target="_blank">HttpServer</a></td>
      <td>dart:io</td>
      <td>Server-side object to handle HTTP communication with clients</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dart_io/HttpResponse.html" target="_blank">HttpResponse</a></td>
      <td>dart:io</td>
      <td>Server-side object to carry response to client requests</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dart_async/Stream.html" target="_blank">Streams</a></td>
      <td>dart:async</td>
      <td>A stream of data</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dart_async/Future.html" target="_blank">Future</a></td>
      <td>dart:async</td>
      <td>A way to get a value asynchronously</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/dart_convert.html#JSON" target="_blank">JSON</a></td>
      <td>dart:convert</td>
      <td>The default implementation of a JSON converter</td>
    </tr>
    <tr>
      <td><a href="https://api.dartlang.org/polymer.html" target="_blank">Polymer</a></td>
      <td>Polymer</td>
      <td>Custom elements, data binding, templates</td>
    </tr>
  </tbody>
</table>

<h2 id="binding-data">Two-way data binding using Polymer</h2>

<p>The slambook sample uses Polymer’s two-way data binding to
bind the values of input elements to Dart variables.
If the user changes the value in an input element,
the bound variable in the Dart code automatically changes.
Or if the Dart code changes the value of the bound variable,
the UI automatically updates.
<a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/polymer-intro/">Define a Custom Element</a>
provides introductory details about Polymer and
about data binding.</p>

<p>The example also uses declarative event handler mapping to hook
event handler functions to input elements.</p>

<p>With the slambook example,
you can see two-way data binding used with a variety of input elements,
including new HTML5 elements.
This table summarizes the two-way data binding attributes
you can use with Polymer:</p>

<table class="table">
  <thead>
    <tr>
      <th>Attribute</th>
      <th>Dart type</th>
      <th>Input element</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>value</td>
      <td>String</td>
      <td>any</td>
    </tr>
    <tr>
      <td>selectedIndex</td>
      <td>integer</td>
      <td>a &lt;select&gt; element in which only one choice is allowed</td>
    </tr>
    <tr>
      <td>checked</td>
      <td>bool</td>
      <td>individual radio buttons or checkboxes</td>
    </tr>
  </tbody>
</table>

<h3 id="using-value-with-any-input-element">Using value with any input element</h3>

<p>The <code>value</code> attribute works with any input element
and binds the value to a Dart string.
This example uses <code>value</code> with a text field, a text area,
a color picker, a date chooser, and a range element.</p>

<p><img class="scale-img-max" src="images/bind-value.png" alt="Two-way data binding with value and strings" /></p>

<p>(Note that some surrounding code,
such as that for the labels,
has been removed for readability.)</p>

<p>A map called <code>theData</code> in the Dart code contains the data for the form.
The code marks the map object with <code>@observable</code> and calls <code>toObservable()</code>
to make the bindings.</p>

<p>The map contains a key-value pair for each input element,
where the key is a string.
The values for elements bound with <code>value</code> are all strings.
The HTML refers to the items in the map
using their Dart names (identifiers).
For example, the value of the color picker is bound to
<code>theData['favoriteColor']</code>.</p>

<h3 id="using-selectedindex-with-a-pull-down-menu">Using selectedIndex with a pull-down menu</h3>

<p>A &lt;select&gt; element contains one or more &lt;option&gt; elements,
only one of which, by default, can be selected at a time.
A single-select element is usually implemented as a pull-down menu.
You can use the <code>selectedIndex</code> attribute
to bind a Dart integer to a pull-down menu.
The integer indicates the index of the selected item.
Indices begin at 0.</p>

<p><img class="scale-img-max" src="images/bind-selected.png" alt="The selectedIndex attribute with a single-selection pull-down menu" /></p>

<h3 id="using-checked-with-checkboxes">Using checked with checkboxes</h3>

<p>You can use the <code>checked</code> attribute
to bind a Dart boolean to a single checkbox.
Here each checkbox is bound to a separate boolean value within a map.</p>

<p><img class="scale-img-max" src="images/bind-checked.png" alt="The checked attribute with individual checkboxes" /></p>

<h2 id="other-resources">Other resources</h2>

<ul>
  <li> The code that handles the communication between the
       client and server is based on code written and explained
       by Chris Buckett in
       <a href="http://takyam-git.github.io/www.dartlang.org/articles/json-web-service/">Using Dart with JSON Web Services</a>.
  </li>
  <li> The previous tutorial,
       <a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/fetchdata/">Fetch Data Dynamically</a>,
       contains a more basic client program that relies on the server
       within Dart Editor (port 3030 on localhost),
       to serve the contents of a JSON file.
  </li>
</ul>

<h3 id="what-next">What next?</h3>

<p>The next tutorial,
<a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/indexeddb">Use IndexedDB</a>,
describes how to save data on the client
in the browser’s Indexed Database.</p>



  </article>
</div>

<!-- NAVI LINKS -->
<div id="tutorial-navigation-links-bottom" class="row">
  <div class="col-md-12">
    <hr />
    <div class="row">
      <div class="col-md-3">
        <a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/"><img src="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/images/tute-home.png" width="36" /></a>
      </div>
      <div class="col-md-3">
        <a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/fetchdata/"><i class="glyphicon glyphicon-chevron-left"> </i> Fetch Data Dynamically</a>
      </div>
      <div class="col-md-3">
      </div>
      <div class="col-md-3">
        <a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/indexeddb/" class="pull-right">Use IndexedDB <i class="glyphicon glyphicon-chevron-right"> </i> </a>
      </div>
    </div> 
  </div> 
</div>


      </div>
    </div>
  </div>
</div>


  <footer class="footer container-full hidden-print">
    <div class="container">
      <div class="row">
        <div class="col-md-5">
          <h3>A new language, with tools and libraries, for SCALABLE web app engineering</h3>
          <p>Dart is an <a href="https://code.google.com/p/dart/">open-source project</a> with contributors from Google and elsewhere.</p>
          <p class="sm">Except as otherwise noted, the content of this page is licensed under the Creative Commons Attribution 3.0 License, and code samples are licensed under the BSD License.</p>
        </div>
        <div class="col-md-2 col-md-offset-1">
          <h4>Popular Topics</h4>
          <ul>
            <li><a href="http://takyam-git.github.io/www.dartlang.org/polymer/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">Polymer.dart</a></li>
            <li><a href="http://takyam-git.github.io/www.dartlang.org/performance/">Performance</a></li>
            <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/dart-up-and-running/ch02.html?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">Language tour</a> &amp;
            <a href="http://takyam-git.github.io/www.dartlang.org/docs/dart-up-and-running/ch03.html?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">library tour</a></li>
            <li><a href="http://takyam-git.github.io/www.dartlang.org/samples/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">Code samples</a></li>
            <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/tutorials/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">Tutorials</a> &amp;
                <a href="http://takyam-git.github.io/www.dartlang.org/codelabs/darrrt/?utm_source=site&amp;utm_medium=footer&amp;utm_campaign=homepage">code lab</a></li>
          </ul>
        </div>
        <div class="col-md-2">
          <h4>Resources</h4>
          <ul>
            <li><a href="http://pub.dartlang.org/">Pub packages</a></li>
            <li><a href="http://takyam-git.github.io/www.dartlang.org/docs/synonyms/">Synonyms with other languages</a></li>
            <li><a href="http://code.google.com/p/dart/issues/list">Dart bugs and feature requests</a></li>
            <li><a href="https://github.com/dart-lang/dartlang.org">www.dartlang.org repo</a></li>
          </ul>
        </div>
        <div class="col-md-2">
          <h4>Community</h4>
          <ul>
            <li><a href="http://takyam-git.github.io/www.dartlang.org/support/">Mailing lists</a></li>
            <li><a href="https://plus.google.com/communities/114566943291919232850">G+ community</a></li>
            <li><a href="https://plus.google.com/+dartlang/posts">G+ announcement group</a></li>
            <li><a href="http://stackoverflow.com/questions/tagged/dart">Stack Overflow</a></li>
          </ul>
        </div>
      </div>
    </div>
  </footer> <!-- End footer -->



<script type='text/javascript' src='http://takyam-git.github.io/www.dartlang.org/bundles/514ef0286af67b679d4820fd3c90e3ce.js'></script>




<link rel='stylesheet' type='text/css' href='http://takyam-git.github.io/www.dartlang.org/bundles/2afe6beaa026f8648e912263a89be985.css' />






</body>
</html>

